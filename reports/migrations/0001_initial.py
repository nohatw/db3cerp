# Generated by Django 4.2.24 on 2025-12-02 18:40

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='AnnualSalesSummary',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('report_year', models.IntegerField(db_index=True, unique=True, verbose_name='報表年份')),
                ('total_revenue', models.DecimalField(decimal_places=0, default=0, max_digits=12, verbose_name='總收入')),
                ('total_orders', models.IntegerField(default=0, verbose_name='總訂單數')),
                ('total_products_sold', models.IntegerField(default=0, verbose_name='總銷售產品數')),
                ('avg_monthly_revenue', models.DecimalField(decimal_places=2, default=0, max_digits=12, verbose_name='月均收入')),
                ('active_users_count', models.IntegerField(default=0, help_text='本年有訂單的用戶數', verbose_name='活躍用戶數')),
                ('new_users_count', models.IntegerField(default=0, help_text='本年首次下單的用戶數', verbose_name='新增用戶數')),
                ('revenue_by_role', models.JSONField(blank=True, default=dict, help_text="格式：{'AGENT': 6000000, 'DISTRIBUTOR': 3600000, ...}", verbose_name='按角色統計收入')),
                ('top_product_types', models.JSONField(blank=True, default=list, help_text="格式：[{'type': 'esim', 'quantity': 12000, 'revenue': 6000000}, ...]", verbose_name='熱門產品類型')),
                ('monthly_trend', models.JSONField(blank=True, default=list, help_text="格式：[{'month': 1, 'revenue': 500000}, ...]", verbose_name='每月收入趨勢')),
                ('quarterly_comparison', models.JSONField(blank=True, default=dict, help_text="格式：{'Q1': 1500000, 'Q2': 1800000, ...}", verbose_name='季度比較')),
                ('yoy_revenue_growth', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True, verbose_name='同比收入增長率(%)')),
                ('yoy_user_growth', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True, verbose_name='同比用戶增長率(%)')),
                ('highlights', models.JSONField(blank=True, default=dict, help_text="格式：{'peak_month': 12, 'peak_revenue': 800000, 'top_user': 'xxx', ...}", verbose_name='業績亮點')),
                ('is_finalized', models.BooleanField(default=False, verbose_name='是否已結算')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='建立時間')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新時間')),
            ],
            options={
                'verbose_name': '每年營業總結',
                'verbose_name_plural': '每年營業總結',
                'ordering': ['-report_year'],
            },
        ),
        migrations.CreateModel(
            name='DailySalesSummary',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('report_date', models.DateField(db_index=True, unique=True, verbose_name='報表日期')),
                ('total_revenue', models.DecimalField(decimal_places=0, default=0, max_digits=12, verbose_name='總收入')),
                ('total_orders', models.IntegerField(default=0, verbose_name='總訂單數')),
                ('total_products_sold', models.IntegerField(default=0, verbose_name='總銷售產品數')),
                ('revenue_by_role', models.JSONField(blank=True, default=dict, help_text="格式：{'AGENT': 50000, 'DISTRIBUTOR': 30000, ...}", verbose_name='按角色統計收入')),
                ('top_product_types', models.JSONField(blank=True, default=list, help_text="格式：[{'type': 'esim', 'quantity': 100, 'revenue': 50000}, ...]", verbose_name='熱門產品類型')),
                ('is_finalized', models.BooleanField(default=False, verbose_name='是否已結算')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='建立時間')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新時間')),
            ],
            options={
                'verbose_name': '每日營業總結',
                'verbose_name_plural': '每日營業總結',
                'ordering': ['-report_date'],
            },
        ),
        migrations.CreateModel(
            name='MonthlySalesSummary',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('report_year', models.IntegerField(db_index=True, verbose_name='報表年份')),
                ('report_month', models.IntegerField(db_index=True, verbose_name='報表月份')),
                ('total_revenue', models.DecimalField(decimal_places=0, default=0, max_digits=12, verbose_name='總收入')),
                ('total_orders', models.IntegerField(default=0, verbose_name='總訂單數')),
                ('total_products_sold', models.IntegerField(default=0, verbose_name='總銷售產品數')),
                ('avg_daily_revenue', models.DecimalField(decimal_places=2, default=0, max_digits=12, verbose_name='日均收入')),
                ('active_users_count', models.IntegerField(default=0, help_text='本月有訂單的用戶數', verbose_name='活躍用戶數')),
                ('revenue_by_role', models.JSONField(blank=True, default=dict, help_text="格式：{'AGENT': 500000, 'DISTRIBUTOR': 300000, ...}", verbose_name='按角色統計收入')),
                ('top_product_types', models.JSONField(blank=True, default=list, help_text="格式：[{'type': 'esim', 'quantity': 1000, 'revenue': 500000}, ...]", verbose_name='熱門產品類型')),
                ('daily_trend', models.JSONField(blank=True, default=list, help_text="格式：[{'date': '2025-12-01', 'revenue': 50000}, ...]", verbose_name='每日收入趨勢')),
                ('yoy_revenue_growth', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True, verbose_name='同比收入增長率(%)')),
                ('mom_revenue_growth', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True, verbose_name='環比收入增長率(%)')),
                ('is_finalized', models.BooleanField(default=False, verbose_name='是否已結算')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='建立時間')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新時間')),
            ],
            options={
                'verbose_name': '每月營業總結',
                'verbose_name_plural': '每月營業總結',
                'ordering': ['-report_year', '-report_month'],
                'indexes': [models.Index(fields=['report_year', 'report_month'], name='reports_mon_report__420756_idx')],
                'unique_together': {('report_year', 'report_month')},
            },
        ),
        migrations.CreateModel(
            name='MonthlySalesReport',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('report_year', models.IntegerField(db_index=True, verbose_name='報表年份')),
                ('report_month', models.IntegerField(db_index=True, verbose_name='報表月份')),
                ('total_revenue', models.DecimalField(decimal_places=0, default=0, max_digits=12, verbose_name='總收入')),
                ('total_orders', models.IntegerField(default=0, verbose_name='訂單數量')),
                ('total_products_sold', models.IntegerField(default=0, verbose_name='銷售產品數量')),
                ('avg_daily_revenue', models.DecimalField(decimal_places=2, default=0, max_digits=12, verbose_name='日均收入')),
                ('avg_daily_orders', models.DecimalField(decimal_places=2, default=0, max_digits=10, verbose_name='日均訂單數')),
                ('active_days', models.IntegerField(default=0, help_text='有訂單的天數', verbose_name='活躍天數')),
                ('product_breakdown', models.JSONField(blank=True, default=dict, help_text="格式：{'esim': {'quantity': 300, 'revenue': 150000}, ...}", verbose_name='產品類型明細')),
                ('order_source_breakdown', models.JSONField(blank=True, default=dict, help_text="格式：{'ERP': {'orders': 50, 'revenue': 30000}, ...}", verbose_name='訂單來源明細')),
                ('daily_details', models.JSONField(blank=True, default=list, help_text="格式：[{'date': '2025-12-01', 'revenue': 5000, 'orders': 10}, ...]", verbose_name='每日明細')),
                ('yoy_revenue_growth', models.DecimalField(blank=True, decimal_places=2, help_text='與去年同月相比的增長率', max_digits=10, null=True, verbose_name='同比收入增長率(%)')),
                ('yoy_order_growth', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True, verbose_name='同比訂單增長率(%)')),
                ('mom_revenue_growth', models.DecimalField(blank=True, decimal_places=2, help_text='與上月相比的增長率', max_digits=10, null=True, verbose_name='環比收入增長率(%)')),
                ('mom_order_growth', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True, verbose_name='環比訂單增長率(%)')),
                ('is_finalized', models.BooleanField(default=False, help_text='月底結算後設為True', verbose_name='是否已結算')),
                ('last_updated', models.DateTimeField(auto_now=True, verbose_name='最後更新時間')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='建立時間')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='monthly_sales_reports', to=settings.AUTH_USER_MODEL, verbose_name='用戶')),
            ],
            options={
                'verbose_name': '營業收入月報表',
                'verbose_name_plural': '營業收入月報表',
                'ordering': ['-report_year', '-report_month', '-total_revenue'],
                'indexes': [models.Index(fields=['report_year', 'report_month', 'user'], name='reports_mon_report__4ffaf2_idx'), models.Index(fields=['report_year', 'report_month', '-total_revenue'], name='reports_mon_report__cf1d98_idx'), models.Index(fields=['user', '-report_year', '-report_month'], name='reports_mon_user_id_93c3c2_idx')],
                'unique_together': {('report_year', 'report_month', 'user')},
            },
        ),
        migrations.CreateModel(
            name='DailySalesReport',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('report_date', models.DateField(db_index=True, verbose_name='報表日期')),
                ('total_revenue', models.DecimalField(decimal_places=0, default=0, max_digits=12, verbose_name='總收入')),
                ('total_orders', models.IntegerField(default=0, verbose_name='訂單數量')),
                ('total_products_sold', models.IntegerField(default=0, verbose_name='銷售產品數量')),
                ('product_breakdown', models.JSONField(blank=True, default=dict, help_text="格式：{'esim': {'quantity': 10, 'revenue': 5000}, 'esimimg': {...}}", verbose_name='產品類型明細')),
                ('order_source_breakdown', models.JSONField(blank=True, default=dict, help_text="格式：{'ERP': {'orders': 5, 'revenue': 3000}, 'SHOPEE': {...}}", verbose_name='訂單來源明細')),
                ('is_finalized', models.BooleanField(default=False, help_text='每日結算後設為True，防止重複計算', verbose_name='是否已結算')),
                ('last_updated', models.DateTimeField(auto_now=True, verbose_name='最後更新時間')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='建立時間')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='daily_sales_reports', to=settings.AUTH_USER_MODEL, verbose_name='用戶')),
            ],
            options={
                'verbose_name': '營業收入日報表',
                'verbose_name_plural': '營業收入日報表',
                'ordering': ['-report_date', '-total_revenue'],
                'indexes': [models.Index(fields=['report_date', 'user'], name='reports_dai_report__f8cb42_idx'), models.Index(fields=['report_date', '-total_revenue'], name='reports_dai_report__6b12f4_idx'), models.Index(fields=['user', '-report_date'], name='reports_dai_user_id_dc776c_idx')],
                'unique_together': {('report_date', 'user')},
            },
        ),
        migrations.CreateModel(
            name='AnnualSalesReport',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('report_year', models.IntegerField(db_index=True, verbose_name='報表年份')),
                ('total_revenue', models.DecimalField(decimal_places=0, default=0, max_digits=12, verbose_name='總收入')),
                ('total_orders', models.IntegerField(default=0, verbose_name='訂單數量')),
                ('total_products_sold', models.IntegerField(default=0, verbose_name='銷售產品數量')),
                ('avg_monthly_revenue', models.DecimalField(decimal_places=2, default=0, max_digits=12, verbose_name='月均收入')),
                ('avg_monthly_orders', models.DecimalField(decimal_places=2, default=0, max_digits=10, verbose_name='月均訂單數')),
                ('active_months', models.IntegerField(default=0, help_text='有訂單的月數', verbose_name='活躍月數')),
                ('peak_month', models.IntegerField(blank=True, null=True, verbose_name='業績最高月份')),
                ('peak_month_revenue', models.DecimalField(blank=True, decimal_places=0, max_digits=12, null=True, verbose_name='最高月份收入')),
                ('lowest_month', models.IntegerField(blank=True, null=True, verbose_name='業績最低月份')),
                ('lowest_month_revenue', models.DecimalField(blank=True, decimal_places=0, max_digits=12, null=True, verbose_name='最低月份收入')),
                ('product_breakdown', models.JSONField(blank=True, default=dict, help_text="格式：{'esim': {'quantity': 3600, 'revenue': 1800000}, ...}", verbose_name='產品類型明細')),
                ('order_source_breakdown', models.JSONField(blank=True, default=dict, help_text="格式：{'ERP': {'orders': 600, 'revenue': 360000}, ...}", verbose_name='訂單來源明細')),
                ('monthly_details', models.JSONField(blank=True, default=list, help_text="格式：[{'month': 1, 'revenue': 50000, 'orders': 100}, ...]", verbose_name='每月明細')),
                ('quarterly_stats', models.JSONField(blank=True, default=dict, help_text="格式：{'Q1': {'revenue': 150000, 'orders': 300}, ...}", verbose_name='季度統計')),
                ('yoy_revenue_growth', models.DecimalField(blank=True, decimal_places=2, help_text='與去年相比的增長率', max_digits=10, null=True, verbose_name='同比收入增長率(%)')),
                ('yoy_order_growth', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True, verbose_name='同比訂單增長率(%)')),
                ('revenue_trend', models.CharField(blank=True, help_text='GROWING/STABLE/DECLINING', max_length=20, null=True, verbose_name='收入趨勢')),
                ('is_finalized', models.BooleanField(default=False, help_text='年底結算後設為True', verbose_name='是否已結算')),
                ('last_updated', models.DateTimeField(auto_now=True, verbose_name='最後更新時間')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='建立時間')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='annual_sales_reports', to=settings.AUTH_USER_MODEL, verbose_name='用戶')),
            ],
            options={
                'verbose_name': '營業收入年報表',
                'verbose_name_plural': '營業收入年報表',
                'ordering': ['-report_year', '-total_revenue'],
                'indexes': [models.Index(fields=['report_year', 'user'], name='reports_ann_report__445423_idx'), models.Index(fields=['report_year', '-total_revenue'], name='reports_ann_report__564c60_idx'), models.Index(fields=['user', '-report_year'], name='reports_ann_user_id_e5b238_idx')],
                'unique_together': {('report_year', 'user')},
            },
        ),
    ]
